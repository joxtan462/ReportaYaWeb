<header class="header">
  <div class="logo-container">
    <img src="assets/Logo-San-Bernardo.png" alt="Municipalidad de San Bernardo" class="logo-muni" />
    <img src="assets/logo.png" alt="Sistema de Alertas" class="logo-app" />
  </div>

  <div class="user-greeting">
    <span style="color: white">Bienvenido, <strong>{{ usuarioNombre || 'Usuario' }}</strong> ({{ usuarioRango || 'Invitado' }})</span>
    <button class="btn-logout" (click)="cerrarSesion()">ğŸšª Cerrar SesiÃ³n</button>
  </div>
</header>

<div class="main-content">

  <!-- MENÃš LATERAL -->
  <aside class="sidebar">
    <nav>
      <ul>
        <li>
          <a [routerLink]="['/menu']" routerLinkActive="active">
            <span class="icon">ğŸ </span> MenÃº
          </a>
        </li>
        <li *ngIf="puedeVer('alertasvecinales')">
          <a [routerLink]="['/alertasvecinales']" routerLinkActive="active">
            <span class="icon">ğŸš¨</span> Alertas Vecinales
          </a>
        </li>

        <!-- ğŸ”¹ Ruta: camarassolicitadas -->
        <li *ngIf="puedeVer('camarassolicitadas')">
          <a [routerLink]="['/camarassolicitadas']" routerLinkActive="active">
            <span class="icon">ğŸ“¹</span> CÃ¡maras Solicitadas
          </a>
        </li>

        <!-- ğŸ”¹ Ruta: mapa -->
        <li *ngIf="puedeVer('mapa')">
          <a [routerLink]="['/mapa']" routerLinkActive="active">
            <span class="icon">ğŸ—ºï¸</span> Mapa en Vivo
          </a>
        </li>

        <!-- ğŸ”¹ Ruta: multas -->
        <li *ngIf="puedeVer('multas')">
          <a [routerLink]="['/multas']" routerLinkActive="active">
            <span class="icon">ğŸ’°</span> Multas
          </a>
        </li>

        <!-- ğŸ”¹ Ruta: crearusuario -->
        <li *ngIf="puedeVer('crearusuario') && !isCurrentRoute('/crearusuario')">
          <a [routerLink]="['/crearusuario']" routerLinkActive="active">
            <span class="icon">ğŸ‘¥</span> Crear Usuario
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="main-area">
    <div class="formulario-card">
      <div class="formulario-header">
        <div class="formulario-icon">
          ğŸ‘¥
        </div>
        <h2>Crear Nuevo Usuario</h2>
        <p>Registra un nuevo usuario en el sistema con los datos necesarios.</p>
      </div>

      <form class="formulario" #usuarioForm="ngForm" (ngSubmit)="crearUsuario(usuarioForm)">
        <div class="campo">
          <label for="nombre">
            <span class="icono-campo">ğŸ‘¤</span> Nombre Completo
          </label>
          <input
            type="text"
            id="nombre"
            name="nombre"
            [(ngModel)]="nombre"
            required
            placeholder="Ej: Juan PÃ©rez"
            class="input-text"
            [class.error]="usuarioForm.form.get('nombre')?.invalid && usuarioForm.form.get('nombre')?.touched"
          />
          <div class="mensaje-error" *ngIf="usuarioForm.form.get('nombre')?.invalid && usuarioForm.form.get('nombre')?.touched">
            El nombre es obligatorio.
          </div>
        </div>

        <div class="campo">
          <label for="correo">
            <span class="icono-campo">ğŸ“§</span> Correo ElectrÃ³nico
          </label>
          <input
            type="email"
            id="correo"
            name="correo"
            [(ngModel)]="correo"
            required
            placeholder="Ej: juan@empresa.cl"
            class="input-text"
            [class.error]="usuarioForm.form.get('correo')?.invalid && usuarioForm.form.get('correo')?.touched"
          />
          <div class="mensaje-error" *ngIf="usuarioForm.form.get('correo')?.invalid && usuarioForm.form.get('correo')?.touched">
            Ingresa un correo vÃ¡lido.
          </div>
        </div>

        <div class="campo">
          <label for="password">
            <span class="icono-campo">ğŸ”’</span> ContraseÃ±a
          </label>
          <input
            type="password"
            id="password"
            name="password"
            [(ngModel)]="password"
            required
            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
            class="input-text"
            minlength="6"
            [class.error]="usuarioForm.form.get('password')?.invalid && usuarioForm.form.get('password')?.touched"
          />
          <div class="mensaje-error" *ngIf="usuarioForm.form.get('password')?.invalid && usuarioForm.form.get('password')?.touched">
            La contraseÃ±a debe tener al menos 6 caracteres.
          </div>
        </div>

        <div class="campo">
          <label for="rango">
            <span class="icono-campo">âš™ï¸</span> Rango
          </label>
          <select
            id="rango"
            name="rango"
            [(ngModel)]="rango"
            required
            class="input-select"
            [class.error]="usuarioForm.form.get('rango')?.invalid && usuarioForm.form.get('rango')?.touched"
          >
            <option value="">Selecciona un rango</option>
            <option value="admin">Administrador</option>
            <option value="camaras">CÃ¡maras</option>
            <option value="multas">Multas</option>
            <option value="inspector">Inspector</option>
            <option value="usuario">Usuario</option>
          </select>
          <div class="mensaje-error" *ngIf="usuarioForm.form.get('rango')?.invalid && usuarioForm.form.get('rango')?.touched">
            Selecciona un rango.
          </div>
        </div>

        <div class="acciones">
          <button type="button" class="btn-secondary" (click)="volver()">
            â† Volver
          </button>
          <button type="submit" class="btn-primary" [disabled]="!usuarioForm.form.valid">
            ğŸ‘¥ Crear Usuario
          </button>
        </div>
      </form>
    </div>
  </main>
</div>
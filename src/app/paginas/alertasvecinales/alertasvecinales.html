<header class="header">
  <div class="logo-container">
    <img src="assets/Logo-San-Bernardo.png" alt="Municipalidad de San Bernardo" class="logo-muni" />
    <img src="assets/logo.png" alt="Sistema de Alertas" class="logo-app" />
  </div>

  <div class="user-greeting">
    <span style="color: white">Bienvenido, <strong>{{ usuarioNombre }}</strong> ({{ usuarioRango }})</span>
    <button class="btn-logout" (click)="cerrarSesion()">ğŸšª Cerrar SesiÃ³n</button>
  </div>
</header>

<div class="main-content">

  <!-- MENÃš LATERAL -->
  <aside class="sidebar">
    <nav>
      <ul>
        <!-- ğŸ”¹ BotÃ³n "MenÃº" que aparece solo cuando estÃ¡s en /alertasvecinales -->
        <li *ngIf="isCurrentRoute('/alertasvecinales')">
          <a [routerLink]="['/menu']" routerLinkActive="active">
            <span class="icon">ğŸ </span> MenÃº
          </a>
        </li>

        <!-- ğŸ”¹ BotÃ³n "Alertas Vecinales" -->
        <li *ngIf="puedeVer('alertasvecinales')">
          <a [routerLink]="['/alertasvecinales']" routerLinkActive="active">
            <span class="icon">ğŸš¨</span> Alertas Vecinales
          </a>
        </li>

        <li *ngIf="puedeVer('camarassolicitadas')">
          <a [routerLink]="['/camarassolicitadas']" routerLinkActive="active">
            <span class="icon">ğŸ“¹</span> CÃ¡maras Solicitadas
          </a>
        </li>
        <li *ngIf="puedeVer('mapa')">
          <a [routerLink]="['/mapa']" routerLinkActive="active">
            <span class="icon">ğŸ—ºï¸</span> Mapa en Vivo
          </a>
        </li>
        <li *ngIf="puedeVer('multas')">
          <a [routerLink]="['/multas']" routerLinkActive="active">
            <span class="icon">ğŸ’°</span> Multas
          </a>
        </li>
        <li *ngIf="puedeVer('crearusuario')">
          <a [routerLink]="['/crearusuario']" routerLinkActive="active">
            <span class="icon">ğŸ‘¥</span> Crear Usuario
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="main-area">
    <div class="alertas-container">
      <h2>ğŸš¨ Alertas Vecinales</h2>

      <!-- ğŸ” Filtros -->
      <div class="filters">
        <input type="text" placeholder="Filtrar por correo" [(ngModel)]="filtroCorreo" (input)="aplicarFiltros()" />
        <input type="text" placeholder="Filtrar por descripciÃ³n" [(ngModel)]="filtroDescripcion" (input)="aplicarFiltros()" />
        <input type="text" placeholder="Filtrar por ubicaciÃ³n" [(ngModel)]="filtroUbicacion" (input)="aplicarFiltros()" />
        <input type="date" placeholder="Filtrar por fecha" [(ngModel)]="filtroFecha" (input)="aplicarFiltros()" />
      </div>

      <!-- ğŸ“‹ Lista de alertas -->
      <div class="alertas-list">
        <div
          *ngFor="let alerta of alertasFiltradas"
          class="alerta-card"
          (click)="irADetalle(alerta)"
        >
          <div class="alerta-header">
            <span class="correo">{{ alerta.usuarioEmail || 'AnÃ³nimo' }}</span>
            <span class="fecha">{{ alerta.fechaString || 'Fecha no disponible' }}</span>
          </div>
          <div class="alerta-body">
            <p><strong>ID:</strong> {{ alerta.id }}</p>
            <p><strong>UbicaciÃ³n:</strong> {{ alerta.ubicacion || 'No especificada' }}</p>
            <p><strong>DescripciÃ³n:</strong> {{ alerta.descripcion ? (alerta.descripcion.length > 150 ? alerta.descripcion.substring(0, 150) + '...' : alerta.descripcion) : 'Sin descripciÃ³n' }}</p>
          </div>
          <div class="alerta-footer">
            <div class="prioridad-acciones">
              <span class="prioridad" [class]="(alerta.prioridad || 'baja')">{{ 'Prioridad: ' + (alerta.prioridad || 'baja') }}</span>
              <div class="acciones" *ngIf="usuario?.rango === 'admin'">
                <button (click)="cambiarPrioridad(alerta, 'baja'); $event.stopPropagation()">Baja</button>
                <button (click)="cambiarPrioridad(alerta, 'media'); $event.stopPropagation()">Media</button>
                <button (click)="cambiarPrioridad(alerta, 'alta'); $event.stopPropagation()">Alta</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>